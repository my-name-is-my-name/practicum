# Оптимизация производственных процессов плавки стали при помощи машинного обучения

В работе рассмотрена задача уменьшения потребления электроэнергии на этапе обработки стали на металлургиеском комбинате. Данная задача решается при помощи построения модели машинного обучения.

**Цель:** построить модель, предсказывающую конечную температуру стали со средней абсолютной ошибкой (MAE) меньше 6.8 градусов.

**Описание этапа обработки:**

Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены в крышке ковша. 
Из сплава выводится сера (десульфурация), добавлением примесей корректируется химический состав и отбираются пробы. Сталь легируют — изменяют её состав — подавая куски сплава из бункера для сыпучих материалов или проволоку через специальный трайб-аппарат (англ. tribe, «масса»).
Перед тем как первый раз ввести легирующие добавки, измеряют температуру стали и производят её химический анализ. Потом температуру на несколько минут повышают, добавляют легирующие материалы и продувают сплав инертным газом. Затем его перемешивают и снова проводят измерения. Такой цикл повторяется до достижения целевого химического состава и оптимальной температуры плавки.
Тогда расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. slab, «плита»).

**Описание данных:**

Данные состоят из файлов, полученных из разных источников:

data_arc_new.csv — данные об электродах;

data_bulk_new.csv — данные о подаче сыпучих материалов (объём);

data_bulk_time_new.csv — данные о подаче сыпучих материалов (время);

data_gas_new.csv — данные о продувке сплава газом;

data_temp_new.csv — результаты измерения температуры;

data_wire_new.csv — данные о проволочных материалах (объём);

data_wire_time_new.csv — данные о проволочных материалах (время).

Во всех файлах столбец key содержит номер партии. В файлах может быть несколько строк с одинаковым значением key: они соответствуют разным итерациям обработки.

**Краткое описание проделанной работы**

Работа выполнена в 3 этапа:
    
1. Изучение данных.
    
   На этом этапе изучены исходные данные, построены графики, приведены наблюдения. На этом этапе изменения в датафреймы не вносились
    
    
2. Предобработка данных.
    
    Выполнены удаление, заполнение пропусков, генерация новых признаков согласно описанным на первом этапе наблюдениям
    Объединение исходных таблиц в одну по ключу (inner join). Удалены признаки с корреляцией Пирсона больше 0.9. Данные разделены на тренировочную и тестовую выборку в отношении 3:1. Данные смасштабированы, скаллер обучен на обучающих данных. 
    
    
3. Построение моделей и получение метрики на кросс-валидации, выбор лучшей модели и тестирование

    Было рассмотрено 3 модели: CatBoostRegressor, LGBMRegressor и RandomForestRegressor. Для поиска гиперпараметров использовадся GridSearchCV.
        
    Лучшая модель:

        CatBoostRegressor(loss_function="MAE", iterations=500, random_state=280823, depth=3, learning_rate=0.1)
        
    Метрика R2 лучшей модели равна 0.45, что означает что модель лучше константной модели
    
    Метрика MAE лучшей модели на тестовой выборке 6.13, что лучше целевого значения 
    
    Также проведено исследование важности признаков. Наиболее важные признаки: продолжительность нагреваа (более 30%) и начальная температура (около 22%)
